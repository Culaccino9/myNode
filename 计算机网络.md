# 1.因特网概述

## 1.1.**网络、互联网（互连网）、因特网**

- **网络：Network**

  - 由若干`结点(Node)`和连接这些结点的`链路(link)`组成。
  - **结点：**比如，笔记本电脑、台式电脑、网络打印机、交换机等。
  - **链路：**这些`节点`互相连接之间称为`链路`
  - **网络：**这些节点与链路称为网络

  ```js
  /*				   链路
  			结点----------结点
  			|			   |
  			|			   |
  			|			   |
  			|			   |链路
  			|			   |
  			|			   |
  			|			   |
  			--------------结点
  			
  		以上就是一个网络
  */
  ```

- **互连网（internet || Network of Network）**

  - 多个`网络`通过`路由器`连接起来，就形成了一个覆盖范围更广的网络，就叫`互连网`
  - 所以，互连网可以说是：**网络的网络**

- **因特网（Internet）**

  - 是世界上最大的网络，用户数以亿计。

- `internet`和`Internet`的区别：
  - `internet`泛指多个计算机网络互联而成的网络，这些网络之间的**通信协议是固定的**
  - `Internet`是一个专有名词，指全球最大的、开放的、自由的众多网络连接而成的特定计算机网络。他采用 **TCP/IP** 协议族作为通信的规则，前身是`ARPANET`



### **1.1.1.Internet发展三个阶段**

- 单个网络`ARPANET`向互连网发展
  - `1969`年，第一个分组交换网`ARPANET`
  - `70年代中期`，研究多种网络之间的互联
  - `1983年`，`TCP/IP协议`称为`ARPANET`的标准协议（**因特网的诞生时间**）
- 逐步建成`三级结构的因特网`
  - `1985年`，NSF围绕六个大型计算机建设`NSFNET`（主干网、地区网、校园网）
  - `1990年`，ARPANET任务完成，正式关闭
  - `1991年`，美国政府将因特网主干网交给私人公司经营，并对接入因特网的单位收费
- 逐渐形成了`多层次ISP`结构的因特网
  - `1993年`，`NSFET`逐渐被若干个商用因特网主干网替代，政府也让各种`因特网提供者ISP`来运营
  - `1994年`，`万维网WWW技术`促使因特网迅速发展
  - `1995年`，NSFNET停止运作，因特网彻底商业化

#### 1.1.1.1.ISP

**ISP（Internet Service Provider）**  **因特网服务提供者（运营商）**如：电信、联通、移动

我们是通过许多`ISP`接入到因特网的，`ISP`可以从因特网管理机构申请到成块的`IP地址`，同时拥有：

`路由器`、`通信线路`等**联网设备**

机构和个人向`IPS`缴纳一定费用得到`IP地址`

<div style="background:red;color:#fff;text-align:center">因特网上所有主机都必须要有IP地址才能进行通信！！</div>



## 1.2.因特网的标准化工作

因特网所有的`RFC(Request For Comments)`技术文档[下载地址:http://www.ietf.org/rfc.html]("http://www.ietf.org/rfc.html")

**因特网协会ISOC**是国际性组织



## 1.3.因特网的组成

- **边缘部分：用户**
  - 所有连接在因特网的`主机`组成，这部分是由`用户直接使用`，用来进行`通信（传输数据、音频）`，如：手机、电脑等
- **核心部分：设备**     为边缘部分提供服务，提供连通性和交换
  - 由大量网络和连接和连接这些网络的`路由器`组成。

**路由器：**

- 解释：是一种专用计算机。
- 作用：实现分组交换。
- 任务：转发收到的分组。是网络核心部分最重要的内容



# 2.三种交换方式

## 2.1.电路交换 Circuit Switching

- 电话交换机接通电话线的方式称为`电路交换`。
- 从通信资源的分配角度来看，`交换（Switching）`就是按照某种方式`动态`的分配`传输线路`的资源。
- 电路交换的三个步骤：
  - `建立连接`（分配通信资源）：`物理连接`，双方通信时`不会`被其他资源占用
  - `通话`（一直占用通信资源）：主叫和被叫双方`互相`通电话。第一步`建立连接`的资源`始终`被占用
  - `释放连接`（归还通信资源）：把刚才占用的`所有`通信资源`归还`给`电信网`。

![电路交换](https://github.com/Culaccino9/myNode/blob/main/img/%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2.png)

如果用`电路交换`来做`网络传输`，效率极其低，因为网络传输是`突发式`的，用户的编辑等会一直占用资源。所以`计算机网络`通常采用`分组交换`



## 2.2.分组交换 Packet Switching

在`因特网`中，`最重要`的的`分组交换机`是`路由器`。它负责`将各种网络互连起来`，并对接收到的分组进行`转发`。

场景：

如果一个用户主机向另一个用户主机`发送数据`，那么我们把表示`该消息的整块数据`称为一个`报文`。

**报文：**

- 发送报文之前，会把报文划分为一个个`更小`的**等长**`数据段`。
- 在每个`数据段`前加上有必要的`控制信息`组成的`首部`，就构成了一个`分组`，这个分组成为**包**。首部也可以称为**包头**。
  - **首部的作用：**
  - 其中包含了分组的`路径地址`。这个路径地址交给`交换机（路由器）`，这样交换机才依据分组转发数据。
  - 分组交换机收到一个分组后，将`分组暂时存储`下来，按照`首部的地址`进行`查表转发`。找到合适的`转发接口`，通过该接口转发给下一个`分组交换机`。

`接受数据的用户主机`，收到分组后，会去掉他们的`首部`。将各数据段组合还原`原始报文`。

分组中可能存在：`丢失`、`误码`、`重复`等问题。在后张篇会介绍。

![分组交换](https://github.com/Culaccino9/myNode/blob/main/img/%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2.png)

## 2.3.报文交换

报文交换主要用于早期的电报通信网，现在`较少`使用，通常被先进的`分组交换`所取代。



## 2.4.三者对比

**电路交换：**

1. 一定要事先建立连接
2. 利用建立的连接发送报文
3. 释放建立的连接

特点：中间各节点交换机是直通形式连接的，比**特流可以直达终点。**传大数据有优势

**优点：**

- 通信时延小：通信线路为通信双方专用，数据直达。适合连续传输大量数据
- 有序传输：只有一条专用线路
- 没有冲突：不会出现争用物理信道的问题
- 适用范围广：适用于传输模拟信号，也适用于传输数字信号
- 实时性强：因为时延小
- 控制简单：节点交换机比较简单。

**缺点：**

- 建立连接时间长
- 线路独占，使用效率低
- 灵活性差，一有错就哦豁
- 难以规格化，难以差错控制



**报文交换：**

可以随时发送报文，不需要事先建立连接

1. 整个报文先传送到`相邻`结点交换机
2. 全部`存储`下来后进行`查表转发`
3. 利用的是各`节点交换机`的转发

特点：`报文`会在`结点`存储转发（需要结点需要**较大的缓存空间**）

**优点：**

- 无需建立连接
- 动态分配线路
- 提高线路可靠性，某一条线路有错误，灵活选择另外一条
- 提高线路利用率
- 提供多目标服务

**缺点：**

- 引起了转发时延：因为存储转发
- 需要较大的缓存空间
- 需要传输额外的信息量：要携带目标地址、源地址



**分组交换：**（这货传输的分组是等长的，便于管理，提高效率）

可以随时`发送分组`，不需要事先`建立连接`

1. 构成原始报文的一个个分组，依次在各`结点`交换机上`存储转发`
2. 各`结点交换机`在发送分组的同时，还`缓存`接受到的分组。

特点：构成`原始报文`的一个个分组，在结点交换机上进行`存储转发`。**有利于差错控制，减少报文长时间占用链路**

**优点：**

- 无需建立连接
- 线路利用率高
- 简化了存储管理（相对报文交换）
- 加速传输
- 减少出错概率和重发数据量

**缺点：**

- 引起了转发时延
- 需要传输额外的信息量
- 对于数据报服务，存在失序、丢失、重复分组的问题
- 对于虚电路服务，存在呼叫建立、数据传输和虚电路释放三个过程



# 3.计算机网络的定义和分类

## 3.1.计算机网络的定义

计算机网络的精确定义`并未统一`。

计算机网络的`最简单`的定义是：一些`互相连接`的，`自治`的计算机`集合`。

- 互连：计算机之间可以通过`有线或无线`的方式进行`数据通信`。
- 自治：是指`独立`的计算机，它有自己的`硬件和软件`，可以`单独运行`。
- 集合：`至少`需要两台计算机。

计算机网络`较好`的定义是：计算机网络主要是由一些`通用的`，`可编程的硬件互连`而成的，而这些硬件并非专门用来实现某一`特定目的`。（如：传送数据或者视频信号）。这些`可编程`的硬件能够用来`传送多种不同类型的数据`，并能够支持`广泛和日益增长的应用`。

- 计算机网络所连接的硬件，并不限于一般的计算机，而是包括了`智能手机`等智能硬件。
- 计算机网络并非专门用来传送数据，而是能够支持`很多种的应用`（包括今后可能出现的各种应用）



## 3.2.计算机网络的分类

**按照交换技术分类：**

- 电路交换网络
- 报文交换网络
- 分组交换网络

**按照使用者分类：**

- 公用网：所有愿意按电信公司规定缴纳费用的人都可以使用这种网络。
- 专用网：某个部门等为了特殊需要专门建立的网，只服务于自己。

**按照传输介质分类：**

- 有线网络
- 无线网络（wifi等）

**按照覆盖范围分类：（重要）**

- 广域网 WAN
  - 覆盖范围：几十公里到几千公里，可以覆盖一个国家、地区，甚至横跨几个洲，所以也成为`远程网`。
  - 是`因特网`的核心部分，任务是为`核心路由器`提供远距离的`高速连接`。
  - `互联`分布在各地的`局域网`和`城域网`。
- 城域网 MAN
  - 覆盖范围：5-50公里，`城市骨干网`。
  - 互联大量企业、机构和学校局域网。
- 局域网 LAN
  - 覆盖范围：一个实验室、一栋楼，1公里左右。
  - 用`微型计算机`或`工作站`通过高速通信线路相连。
- 个域网 PAN
  - 覆盖范围10米。
  - 个人区域网的简称。
  - 不是用来连接普通计算机的。把属于属于个人的设备，如：耳机、鼠标等用无线技术连接起来的网络，所以也成为`无线个人区域网 WPAN`
  - 注意：若中央处理机之间的距离非常近（<1米），则称为`多处理机系统`，不称为计算机网络系统。

**按照拓扑结构分类：（通信子网）**

- 总线型网络
  - 单根网线把计算机连接起来。
  - 优点：建网容易、增减结点方便、节省路线。
  - 缺点：重负载时，通信效率不高，任意一处出现故障，全线瘫痪。
- 星型网络
  - 每个计算机都以单独的线路与中央设备相连。 （中央设备：早期计算机，后来：集线器，现在：交互及或路由器）
  - 优点：便于网络的集中控制和管理。
  - 缺点：成本高，中央设备对故障敏感。
- 环形网络
  - 是将所有计算机的网络接口连接成一个环。（令牌环）
- 网状型网络 
  - 一般情况下，每个结点至少由两条路径与其他结点相连。多用在`广域网`中。
  - 优点：可靠性高。
  - 缺点：控制复杂，线路成本高

以上的结构还可以互相连接形成更加复杂的网络结构。



# 4.计算机网络的性能指标

性能指标可以从不同的方面来度量计算机网络的`性能`。

常见的计算机网络的`性能指标`有以下8个：

- 速率
- 带宽
- 吞吐量
- 时延
- 时延带宽积
- 往返时间
- 利用率
- 丢包率

## 4.1.速率 bit

单位：`比特`

**比特 bit：**

计算机中`数据量`的单位，也是`信息论`中信息量的单位。一个比特就是`二进制`数字中的一个`1或0`。

生活中硬盘标准容量与计算机显示容量不符合，主要是因为计算机按照1024计算，而生活中为了方便按照1000计算。

**速率：**

连接在`计算机网络`上的`主机`在`数字信道`上传送`比特`的速率，也称为`比特率或数据率`。

比特与速率单位：

![比特与速率单位](https://github.com/Culaccino9/myNode/blob/main/img/%E6%AF%94%E7%89%B9%E4%B8%8E%E9%80%9F%E7%8E%87%E5%8D%95%E4%BD%8D.png)

```js
/* 
例：一个待发送的数据块，大小为100MB，网卡的发送速率为100Bbps，则网卡发送完该数据需要多长时间？
100MB / (100Bb/s) 
    = MB / (Mb/s) 
    = 2**20B / (10**6b/s) 
	= 2**20 * 8b / (10**6 b/s)
	=8.388608s
*/
```

## 4.2.带宽 Hz

`信号`所包含的`各种不同频率`成分所占用的`频率范围`。

**单位**：Hz（kHz，MHz，GHz）

**意义：**用来表示网络的`通信线路`所能`传送数据的能力`，因此网络带宽表示在`单位时间`内从网络`某一点到另一点`所能通过的`最高数据率`。

**单位：**b/s （kb/s，Mb/s，Gb/s，Tb/s）

一条通信线路的`带宽`越宽，其所传输数据的`最高数据率`也`越高`

## 4.3.吞吐量

吞吐量表示在`单位时间`内通过某个`网络`（或`信道`、`接口`）的`数据量`。

吞吐量被经常用于对现实世界中的网络的一种测量，以便知道实际上到底有多少数据量能够通过网络。

吞吐量`受网络的带宽`或`额定速率的限制`。

## 4.4.时延

`网络时延`由三部分构成：

- 发送时延
  - 原因：从`源主机`将`分组`发往`传输线路`，产生的时间。
  - 计算公式：分组长度（b）/ 发送速率（b/s ）
    - 发送速率：`网卡的发送速率`、`信道带宽`、`交换机的接口速率`、他们`共同`决定了`发送速率`
- 传播时延
  - 原因：代表着分组信号在`链路`上传输，产生的时间。
  - 计算公式：信道长度（b）/ 电磁波传播速率（m/s） 
    - 电磁波在`自由空间`传播速率为：3 X 10**8 m/s
    - `铜线`传播速率为：2.3 X 10**8 m/s
    - `光纤`传播速率为：2.0 X 10**8 m/s
- 处理时延
  - 原因：`路由器`收到分组后，对其进行存储转发，产生的时间。
  - 计算公式：不方便计算。
  - 还有一个排队时延。

因为有多段链路和多个路由器组成，所以会有多个`传播时延`和`处理时延`。

<div style="background:red;color:#fff">处理时延忽略不计，当数据量大的时候，发送时延占影响速率的主要因素。而数据量小的时候相反。</div>

## 4.5.时延带宽积

就是传播时延 X 带宽

![时延带宽积](https://github.com/Culaccino9/myNode/blob/main/img/%E6%97%B6%E5%BB%B6%E5%B8%A6%E5%AE%BD%E7%A7%AF.png)

## 4.6.往返时间

![往返时间](https://github.com/Culaccino9/myNode/blob/main/img/%E5%BE%80%E8%BF%94%E6%97%B6%E9%97%B4.png)

## 4.7.利用率

- 信道利用率
  - 表示某信道有百分比的时间是被利用的
- 网络利用率
  - 全网络的信道利用率的加权平均

**利用率和时延的关系：**

就像高速公路车多和车少的关系。

- 排队理论，某信道的利用率增大时，该信道引起的时延也会增大。
- 公式：D = D0 / 1 - U  （D：网络当前时延；D0空落空闲时延；U利用率）
  - 当网络利用率达到50%，时延加倍
  - 当网络利用率超过50%，时延指数增大
  - 当网络利用率接近100%，时延趋于无穷大。
- 所以，一些较大主干网的`ISP`通常会控制`信道利用率`不超过50%。超过就`扩容`
- 也不能利用率太低，浪费宝贵的通信资源。
- 所以，就有一种机制，动态调整输入到网络中的通信量，使网络利用率保持在一个合理的范围。`拥塞控制`

##  4.8.丢包率

`丢包率`即`分组丢失率`。是指在一定时间范围内，传输过程中`丢失的分组数量和总分组数量的比率`

可分为：

- 接口丢包率
- 结点丢包率
- 链路丢包率
- 路径丢包率
- 网络丢包率

运维非常关心丢包率。

**分组丢失主要有两种情况：**

- 分组在传输过程中出现`误码`，被`结点`丢弃。
- 分组在到达一台`队列已满`的`分组交换机`时被丢弃。信息量大的时候就可能造成`网络阻塞`

**因此，丢包率反应了网络的拥塞情况：**

- 无拥塞时丢包率为0
- 轻度拥塞为1% ~ 4%
- 严重拥塞为5% ~ 15%

丢包率太高网络就无法正常工作。



# 5.计算机网络体系结构

## 5.1.常见结构

### 5.1.1.OSI体系结构

为了使`不同的计算机网络结构能够互联`，国际标准化组织与`1977年`成立了专门的机构来研究该问题。

他们提出了一个使`不同计算机`在`世界范围`内互联成网的`标准框架`。也就是`开放系统互联参考模型`，简称`OSI`。

### 5.1.2.TCP/IP协议族

他之中包含了`许多协议`，但是TCP和IP`特别重要`，所以用他们来`代表`整个大家族，也被成为`TCP/IP协议族`。

在嵌入式系统开发领域，`TCP/IP协议族`也被成为`TCP/IP协议栈`。因为他的分层结构和数据结构的栈图形画法是一致的。

1. `因特网`从`1983年`开始使用`TCP / IP 协议族`。并逐步演变成了`TCP/IP参考模型`。（商业气息浓重，但是市场占比重）

2. `IP协议`是`网际协议`。所以`TCP/IP体系结构的网络层常被称为网际层`。

3. 用户电脑一般包含`TCP/IP协议族`，也就是`完成四层`。`路由器`虽然包含`TCP/IP体系结构`，但一般只包含`网络接口层和网际层`。

4. `网络接口层`其实并`没有规定`什么`具体内容`，其目的是为了互联`全世界`各种不同的`网络接口`。（例：有线以太网，无线WIFI）

5. `IP协议`是`TCP/IP体系结构`**网际层**的`核心协议`。

   - `IP协议`可以将`不同的网络接口`（也就是**网络接口层**）进行互相连接。

   - 并且向**运输层**的`TCP`、`UDP`协议提供网络互联服务。

   - <div style="background:red;color:#fff;text-align:center">作为TCP/IP体系结构中的<b>核心协议</b>，负责互联不同的<b>网络接口</b>(IP over everthing)</div>

   - <div style="background:red;color:#fff;text-align:center">为网络应用提供服务（Everthing over IP）</div>

6. `TCP`和`UDP`是`TCP/IP体系结构`**运输层**的两个`重要协议`。

   - `TCP`协议向**应用层**的`HTTP`、`SMTP`协议提供`可靠传输`的服务。
   - `UPD`协议向**应用层**的`DNS`、`RTP`提供`不可靠传输`的服务。

7. 大量的协议：`HTTP`、`SMTP`、`DNS`、`RTP`等是**应用层**的协议。

![TCP-IP网络结构](https://github.com/Culaccino9/myNode/blob/main/img/TCP-IP%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84.png)

三者从1开始排序，且对应。

| OSI体系结构（法律上的国际标准） | TCP / IP体系结构（事实上的国际标准） | 原理体系结构（计算机网络的完整体系） |
| :-----------------------------: | :----------------------------------: | :----------------------------------: |
|             物理层              |              网络接口层              |                物理层                |
|           数据链路层            |                                      |              数据链路层              |
|             网络层              |                网际层                |                网络层                |
|             运输层              |                运输层                |                运输层                |
|             会话层              |                                      |                                      |
|             表示层              |                                      |                                      |
|             应用层              |                应用层                |                应用层                |



## 5.2.分层的必要性

计算机网络是个非常复杂的系统，在`ARPANET`设计时就提出了分层的概念。

`分层`可将庞大负责的问题，转化为若干较小的`局部问题`，而这些较小的局部问题就比较容易`研究和处理`。

### 5.2.1.物理层

<div style="background:red;color:#fff;text-align:center">解决使用何种信号来表示传输比特的问题。</div>

**场景：两台计算机相连接（物理层）。**

```js
/*
这些问题都是物理层：
1.考虑其传输媒介（介质）：网线，双绞线。
2.物理接口：RJ45以太网接口。（一般网线接口）
3.使用怎样的信号表示比特0和1。（比如方波信号，但是并不是，只是便于理解）

				解决了这些问题，两台计算机就可以通过信号来传输比特0或1了
*/
```



### 5.2.2.数据链路层

<div style="background:red;color:#fff;text-align:center">解决分组在一个网络（或一段链路）上传输的问题</div>

**场景：总线型网络上，串联了多台主机（数据链路层）**

说明：现在已经不适用总线型网络，而使用`以太网交换机`，交换式以太网。

```js
/*
1.总线型网络上"主机A"要给"主机C"发送数据，表示数据的信号会通过总线传播到总线上的"每一个主机"。那么"主机C"如何知道该数据是发给自己的，从而接受;而"主机B"、"主机D"又怎么分辨数据不是发给自己的呢？
	1.1从而引出了如何标识网络中各主机的问题。（主机编址）
	1.2.主机的MAC地址，就是主机在网络中的地址（唯一主机编址）
	1.3.主机发送数据时，就应该给数据发送目的地址
	1.4.其他主机接收到后就通过MAC来分辨是否接受数据
2.目的主机如何从信号所表示的一连串比特流中区分出"地址和数据"。（分组的封装格式问题）
3.主机B和主机D同时向总线发送数据，造成"信号碰撞"
*/
```



### 5.2.3.网络层

<div style="background:red;color:#fff;text-align:center">解决分组在多个网络上传输（路由）的问题。</div>

1. 在`交互式以太网`中，由大量的路由器和主机构成，就会出现`多个网络`。从而导致一个问题：如何标识`各网络`和`网络中各主机`的问题。（**网络和主机共同编址问题**，如`IP地址`。）
   - **例：IP地址"192.168.1.254和192.168.1.2"**
     - 前面`192.168.1`来标识`网络地址`
     - 后面`254`和`2`来标识他们自己
2. `源主机`和`目的主机`之间的传输路径往往不止一条。`分组`到源主机和目的主机可走不同的路径。就引出了`路由器`如何`转发分组`和`路由选择`的问题。



### 5.2.4.运输层

<div style="background:red;color:#fff;text-align:center">解决进程之间基于网络的通信问题。</div>

**场景：**`一台主机`中运行着`两个与网络通信相关`的`应用进程`。一个**浏览器进程**一个**QQ进程**。这台`服务器`中运行着与`网络通信相关`的`服务器进程`（**Apache**）。主机收到了来自服务器的`分组`。这些分组该交给浏览器进程处理呢？还是交给QQ进程处理呢？

1. 如何`标识`与`网络通信相关的应用进程`，进而解决`进程之间`基于`网络通信`的问题。（端口号port）
2. 如果`路由器繁忙`或者`误码`，导致`路由器`丢弃分组。出现传输错误，如何处理？



### 5.2.5.应用层

<div style="background:red;color:#fff;text-align:center">解决通过应用进程的交互来实现特定网络应用的问题</div>

制定各种`应用层协议`，并按协议标准编写相关的`应用程序`。通过`进程`间的`交互`来完成`特定的网络应用`。

- HTTP协议：支持万维网应用
- SMTP协议：支持电子邮件
- FTP协议：文件传送



## 5.3.计算机网体结构分层思想例子

`浏览器进程`来访问`web服务器`。

输入网址后，主机向web服务器发送请求，web服务器收到请求后，发回相应的响应。收到响应后将其解析为具体的网址内容显示出来。

是主机中的`浏览器进程`和web服务器的`Apache进程`基于`网络的通信`。

|                      主机（浏览器进程）                      |                          路由器接受                          |                          路由器转发                          | web服务器（Apache进程）                                      |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | ------------------------------------------------------------ |
| 一、**应用层**（1.按照HTTP协议规定构建一个`HTTP请求报文`     2.将HTTP请求报文交付给**运输层**处理） |                                                              |                                                              | 五、**应用层**（对`HTTP请求报文`进行`解析`，然后给`主机`发回`HTTP响应报文`）然后层层封装又传给主机 |
| 二、**运输层**（1.给`HTTP请求报文`添加一个`TCP首部`，成为`TCP报文段（HTTP+TCP）`     2.将`TCP报文段`交给**网络层**处理     3.TCP首部作用：为了`区分`应用进程，实现`可靠传输`） |                           四、转发                           |                                                              | 四、**运输层**（将`TCP报文段`的`首部`去掉后，将其交付给**应用层**，实际交付的`HTTP请求报文`） |
| 三、**网络层**（1.给`TCP报文段`添加一个`IP首部`，成为`IP数据报（HTTP+TCP+IP）`     2.将`IP数据报`交给**数据链路层**处理     3.IP首部作用：为了使`IP数据报`可以在互联网上传输，也就是被路由器转发） | 三、**网络层**（1.解析`IP数据报`的`首部`,提取出`目的网络地址`，查找自身的`路由表`，确定转发端口，进行`转发`） |     一、**网络层**（1.将`IP数据报`交付给**数据链路层**）     | 三、**网络层**（将`IP数据报`的`首部`去掉后，将其交付给**运输层**，实际交付的是`TCP报文段`） |
| 四、**数据链路层**（1.给`IP数据报`添加一个`首部`和`尾部`，使其成为`帧`（`TEH+HTTP+TCP+IP+TEH`）  2.将帧交付给**物理层**处理     3.首部作用：能够让`帧`能够在`一段链路`上或者`一个网络`上`传输`，能够被相应`目的主机`接收    4.尾部作用：为了让`目的主机检查`接受到的`帧`是否有`误码`） | 二、**数据链路层**（1.将`帧`的`首部`和`尾部`去掉后     2.将其交付给**网络层**。实际交付的是`IP数据报`） | 二、**数据链路层**（1.给`IP数据报`添加一个`首部`和`尾部`，使其成为`帧`，   2.将帧交给**物理层**） | 二、**数据链路层**（将`帧`的`首部`和`尾部`去掉，将其交付给**网络层**，实际交付的是`IP数据报`） |
| 五、**物理层**（1.将`帧`看作是`比特流（0101012等）`，并给该比特流前面添加`前导码`    2.将添加有`前导码的比特流`变换成相应的信号（对应上文`方波`例子）发送到`传输媒体`   3.作用：让目的主机做好接受`帧`的准备） | 一、**物理层**（1.将信号变换成`比特流`，去前导码   2.交给**数据链路层**。实际交付的是`帧`） | 三、**物理层**（1.将`帧`看作是`比特流`，添加`前导码`    2.变成相应信号发送给`传输媒体`） | 一、**物理层**（将`信号`变成`比特流`，去掉`前导码`，将其交付给**数据链路层**，交付的是`帧`） |
|              六、信号通过`传输媒体`到达`路由器`              |                                                              |        四、信号通过`传输媒体`到达相应的**web服务器**         |                                                              |

**HTTP请求报文：**

- Get/HTTP/1.1
- Accept-Language：en-us
- Accept：\*/*
- Connection：close
- Host：192.168.0.2

**TCP报文段首部格式：**

源端口、目的端口、序号、确认号、数据偏移、保留、紧急、确认、推送、复位、同步、终止、窗口、校验和、紧急指针、选项（长度可变）、填充

**IP数据包首部格式：**

版本、首部长度、区分服务、总长度、标识、标志、片偏移、生存时间、协议、首部检验和、源地址、目的地址、可选字段（长度可变）、填充

**帧首部格式：**

6目的地址   6源地址   2类型

**帧尾部格式：**

4FCS

**前导码内容：**

- 1字节帧开始定界符：11010101
- 7字节前同步码：010101010101010010101010....



## 5.4.计算机网体结构中的专用术语

这些专业术语都来自`OSI`的七层体系结构，但也适用于`TCP/IP`的四层体系结构。

下面将这些术语中`最具代表性`的三个作为分类名称。

- 实体
- 协议
- 服务

### 5.4.1.实体

指任何可`发送`或`接收`信息的`硬件`或`软件进程`。

**对等实体：**指`通信双方`相同`层次`的实体。



### 5.4.2.协议

`协议`是指`控制两个对等实体`进行`逻辑通信`的`规则`。

成为`逻辑通信`是因为这种通信实际并不存在。是我们假设出来的逻辑，便于我们单一管理某一层。

例：

- **应用层**`对等实体`使用应用层协议（`HTTP`、`SMTP`）进行通信。
- **运输层**`对等实体`使用运输层协议（`TCP`、`UDP`）进行通信。
- **网络层**`对等实体`使用网络层协议（`IP`）进行通信。
- **链路层**`对等实体`使用链路层协议（传统以太网`CSMA/CD`）进行通信。
- **物理层**`对等实体`使用物理层协议（传统以太网使用`曼彻斯特编码`）进行通信。

#### 5.4.2.1.协议的三要素

语法、语义、同步

- 语法：定义所交换信息的格式。
  - 例如IP数字报，某一小格子称为`字段或域`，数字表示`字段长度，单位位（比特）`，语法就是定义了这些小格子的长度和先后顺序。
  - 也就是说，`语法`定义所交换信息由`哪些字段`和`何种顺序`构成。
- 语义：定义收发双方所要完成的操作。
  - 例如5.3.举例的。
- 同步：定义收发双发的时序方式。

![协议-同步](F:\myNode\myNode\img\协议-同步.png)

### 5.4.3.服务

在`协议`的控制下， 两个`对等实体`间的`逻辑通信`使得`本层`能够向`上一层`提供服务。

要`实现本层协议`，还需要使用`下面一层`所提供的`服务`。

简而言之：本层提供服务给上一层，而作为本层，享受下一层提供给本层的服务。相对而言，本层作为上一层的提供服务者，上一层也享受本层的服务。

下层协议对上面层协议而言是`透明`的。

协议是`水平`的，服务是`垂直`的。

**服务访问点：**在`同一系统`中，相邻两层的实体交换信息的`逻辑接口`，用于`区分不同的服务类型`。

- **数据链路层**的服务访问点为`帧`的"类型"字段
- **网络层**的服务访问点为`IP数据报`首部中的"协议字段"
- **运输成**的服务访问点为`端口号`

**服务原语：**`上层`使用`下层`所提供的`服务`，必须通过与下层`交换一些命令`，这些`命令`就称为`服务原语`。

**协议数据单元PDU：**`对等层次之间传送的数据包`称为该层的协议数据单元。

- **物理层**对等实体逻辑通信数据包称为`比特流`
- **数据链路层**对等实体逻辑通信数据包称为`帧`
- **网络层**对等实体逻辑通信的数据包称为`分组`
- **运输层**对等实体逻辑通信的数据包一般`根据协议而定`
  - TCP协议称为`TCP报文段`
  - UDP协议称为`UDP用户数据报`
- **应用层**对等实体逻辑通信的数据包一般称为`应用报文`

**服务数据单元SDU：**`同一系统`内，层与层之间交换的数据包称为`服务数据单元`。

**多个SDU可以合成一个PDU，一个SDU也可以划分为几个PDU**

![服务](F:\myNode\myNode\img\服务.png)



# 6.概述
